@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

/* === Theme Variables === */
:root {
  --bg-color: #12101e;
  --primary-glow: #a952ff;
  --secondary-glow: #37c3ff;
  --success-glow: #00ffc3;
  --danger-glow: #ff4d8d;
  --warning-glow: #ffc700;
  --info-glow: #17a2ff;

  --card-bg: rgba(23, 19, 46, 0.6);
  --card-border: rgba(169, 82, 255, 0.3);
  --text-color: #f0f0f0;
  --text-muted: #a09cb6;

  --rank1-color: #ffd700;
  --rank2-color: #c0c0c0;
  --rank3-color: #cd7f32;

  --border-radius: 16px;
  --font-family: 'Poppins', sans-serif;

  --shadow-soft: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
  --shadow-strong: 0 10px 40px rgba(0,0,0,0.5);
}

/* === Reset & Base === */
* { margin: 0; padding: 0; box-sizing: border-box; }
html, body { height: 100%; }
body {
  font-family: var(--font-family);
  background-color: var(--bg-color);
  color: var(--text-color);
  display: flex; justify-content: center; align-items: center;
  min-height: 100vh; padding: 20px; overflow: hidden;
}

/* Background glow */
.background-shapes {
  position: fixed; inset: 0; z-index: -1;
  background:
    radial-gradient(circle at 15% 25%, var(--primary-glow), transparent 30%),
    radial-gradient(circle at 85% 75%, var(--secondary-glow), transparent 30%);
  opacity: 0.2; filter: blur(100px);
}

.game-container {
  width: 100%; max-width: 1200px; height: 95vh; max-height: 850px; position: relative;
}

/* === Screen Management === */
.screen {
  position: absolute; inset: 0;
  opacity: 0; visibility: hidden;
  transform: translateY(20px) scale(0.98);
  transition: all 0.5s cubic-bezier(0.165, 0.84, 0.44, 1);
  display: flex; flex-direction: column; gap: 15px;
}
.screen.active { opacity: 1; visibility: visible; transform: translateY(0) scale(1);}

/* === Animations === */
@keyframes glow {
  from { text-shadow: 0 0 5px #fff, 0 0 10px var(--primary-glow); }
  to   { text-shadow: 0 0 10px #fff, 0 0 20px var(--primary-glow); }
}
.shine { animation: glow 1.5s ease-in-out infinite alternate; }

@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0); }
}
.animate-in { animation: fadeInUp 0.5s ease forwards; }

/* === Cards & Headings === */
.card {
  background: var(--card-bg);
  border: 1px solid var(--card-border);
  border-radius: var(--border-radius);
  padding: 30px;
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
  box-shadow: var(--shadow-soft);
}
.title { text-align: center; margin-bottom: 25px; font-size: 2.5rem; font-weight: 700; color: #fff; }

/* === Buttons === */
.btn {
  padding: 14px 28px; font-size: 1.05rem; font-weight: 600;
  border: 2px solid transparent; border-radius: 10px;
  cursor: pointer; transition: all 0.25s ease;
  display: inline-flex; align-items: center; justify-content: center; gap: 10px;
  text-transform: uppercase; letter-spacing: 0.5px;
}
.btn:hover { transform: translateY(-3px); box-shadow: 0 6px 20px rgba(0,0,0,0.3); }
.btn:active { transform: translateY(-1px); }
.btn-block { width: 100%; }
.btn-compact { padding: 10px 16px; font-size: 0.9rem; white-space: nowrap; }

.btn-primary { background: var(--card-bg); color: var(--text-color); border-color: var(--card-border); }
.btn-primary:hover { background: var(--primary-glow); border-color: var(--primary-glow); color: #fff; box-shadow: 0 0 20px var(--primary-glow); }

.btn-start { background: var(--primary-glow); color: #fff; border: none; }
.btn-start:hover { box-shadow: 0 0 25px var(--primary-glow); }

.btn-secondary { background: #2c3e50; color: #fff; border: 1px solid #2c3e50; }
.btn-secondary:hover { filter: brightness(1.1); }

.btn-danger-outline {
  background: transparent; color: var(--danger-glow);
  border: 2px solid var(--danger-glow);
}
.btn-danger-outline:hover { background: var(--danger-glow); color: #fff; box-shadow: 0 0 20px var(--danger-glow); }

.btn-icon { background: none; padding: 12px; font-size: 1.2rem; color: var(--text-muted); border: none; cursor: pointer; }
.btn-icon:hover { color: var(--primary-glow); transform: scale(1.1); }

.btn-icon-small {
  background: none; padding: 4px 6px; font-size: 0.8rem;
  color: var(--danger-glow); border: none; cursor: pointer;
  border-radius: 4px; transition: all 0.2s ease;
}
.btn-icon-small:hover { background: var(--danger-glow); color: #fff; }

/* Accessibility: Keyboard focus */
button:focus-visible, select:focus-visible, input:focus-visible {
  outline: 2px solid var(--secondary-glow);
  outline-offset: 2px;
}

/* === Toggle Switch === */
.toggle-switch { position: relative; width: 50px; height: 24px; }
.toggle-switch input[type="checkbox"] { opacity: 0; width: 0; height: 0; }
.toggle-slider {
  position: absolute; inset: 0; cursor: pointer; border-radius: 24px;
  background-color: rgba(255,255,255,0.2); transition: 0.3s;
}
.toggle-slider:before {
  content: ""; position: absolute; height: 18px; width: 18px; left: 3px; bottom: 3px;
  background-color: white; border-radius: 50%; transition: 0.3s;
}
input:checked + .toggle-slider { background-color: var(--success-glow); }
input:checked + .toggle-slider:before { transform: translateX(26px); }

/* === Inputs === */
.input-group { position: relative; margin-bottom: 20px; }
.input-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--text-muted); }

input, select {
  background: rgba(0,0,0,0.2); border: 1px solid var(--card-border); border-radius: 10px;
  padding: 14px 14px 14px 45px; color: var(--text-color); font-size: 1rem; width: 100%;
  transition: all 0.3s ease;
}
input:focus, select:focus { outline: none; border-color: var(--primary-glow); box-shadow: 0 0 15px var(--primary-glow); }
input::placeholder { color: var(--text-muted); }
select option { background: #333; color: #fff; }

/* === Setup Screen === */
#setup-screen { display: grid; grid-template-columns: 400px 1fr; align-items: start; gap: 30px; }
.setup-card { display: flex; flex-direction: column; }
.settings-section {
  background: rgba(255,255,255,0.05);
  border-radius: 12px; padding: 20px; margin-bottom: 20px;
  border: 1px solid rgba(255,255,255,0.1);
}
.settings-section h3 {
  color: var(--secondary-glow); margin-bottom: 15px; font-size: 1.2rem;
  display: flex; align-items: center; gap: 8px;
}
.settings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
.setting-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; }
.setting-label { display: flex; align-items: center; gap: 8px; font-weight: 500; color: var(--text-color); }

#leaderboard-preview-container { height: 100%; display: flex; flex-direction: column; }
.preview-title { text-align: center; margin-bottom: 15px; color: var(--text-muted); }

/* === Game Screen === */
#game-screen { display: flex; flex-direction: column; gap: 15px; }
.game-header { display: flex; justify-content: space-between; align-items: stretch; gap: 20px; }

.player-info-card {
  display: flex; justify-content: space-between; align-items: stretch;
  gap: 20px; padding: 15px 20px; flex: 1;
}
.current-player-section { flex: 1; text-align: left; display: flex; flex-direction: column; gap: 6px; }
.player-group { font-size: 1.1rem; font-weight: 700; color: var(--secondary-glow); text-transform: uppercase; }
.player-name { font-size: 2rem; font-weight: 700; line-height: 1.2; color: #fff; }

/* Lifeline info chip */
.lifeline-chip {
  display: inline-flex; align-items: center; gap: 6px;
  background: rgba(255,255,255,0.06); border: 1px solid var(--card-border);
  padding: 6px 10px; border-radius: 999px; font-weight: 700; font-size: 0.9rem; width: fit-content;
}

.live-leaderboard { display: flex; gap: 25px; flex: 2; font-size: 0.85rem; }
.live-players-section, .live-teams-section { display: flex; flex-direction: column; }
.live-players-section { flex: 1.5; }
.live-teams-section { flex: 1; }

.live-section h4 {
  color: var(--secondary-glow); margin-bottom: 10px; font-size: 0.9rem;
  display: flex; align-items: center; gap: 5px;
}
.live-players-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }

.live-list {
  display: flex; flex-direction: column; gap: 4px;
  max-height: 280px; overflow-y: auto;
}
.live-list::-webkit-scrollbar { width: 4px; }
.live-list::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); border-radius: 2px; }
.live-list::-webkit-scrollbar-thumb { background: var(--primary-glow); border-radius: 2px; }

.live-item {
  display: grid; grid-template-columns: auto 1fr auto;
  align-items: center; gap: 8px; padding: 6px 10px; border-radius: 6px;
  background: rgba(255,255,255,0.05); transition: all 0.2s ease; font-size: 0.8rem;
}
.live-item .rank { font-weight: 600; color: var(--text-muted); min-width: 15px; }
.live-item .name { color: var(--text-color); font-weight: 500; text-overflow: ellipsis; overflow: hidden; white-space: nowrap; }
.live-item .score { font-weight: 700; color: var(--success-glow); text-align: right; }

.group-badge {
  font-size: 0.7rem; padding: 2px 6px; border-radius: 10px; font-weight: 700; text-align: center;
}

/* === Timer === */
.timer-container { position: relative; width: 90px; height: 90px; }
.timer-svg { transform: rotate(-90deg); }
.timer-bg, .timer-progress { fill: none; stroke-width: 7; }
.timer-bg { stroke: rgba(255,255,255,0.1); }
.timer-progress {
  stroke: var(--success-glow);
  stroke-linecap: round; transition: stroke 0.5s ease;
  stroke-dasharray: 175.93; stroke-dashoffset: 0;
}
.timer-container.half-time .timer-progress { stroke: var(--warning-glow); }
.timer-text {
  position: absolute; inset: 0; display: grid; place-items: center;
  font-size: 2rem; font-weight: 800;
}

/* === Progress Bar === */
#game-progress-container { width: 100%; background: rgba(0,0,0,0.2); border-radius: 10px; padding: 3px; }
#game-progress-bar {
  height: 10px;
  background: linear-gradient(90deg, var(--primary-glow), var(--secondary-glow));
  border-radius: 7px; width: 0%; transition: width 0.5s ease;
}

/* === Question & Answers === */
.question-container { position: relative; flex-grow: 1; display: flex; flex-direction: column; justify-content: center; }
.question-box {
  font-size: 1.9rem; font-weight: 700; text-align: center;
  background: var(--card-bg); border-radius: var(--border-radius);
  padding: 26px; display: flex; justify-content: center; align-items: center;
  min-height: 120px; line-height: 1.5; opacity: 0;
}
.question-box.animate-in { animation: fadeInUp 0.45s ease forwards; }

.answer-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }

.answer-btn {
  padding: 15px 20px; font-size: 1.08rem; text-align: left;
  background: linear-gradient(rgba(255,255,255,0.05), rgba(255,255,255,0));
  color: var(--text-color); border: 2px solid var(--card-border); border-radius: 10px;
  cursor: pointer; transition: all 0.2s ease; position: relative; opacity: 0;
  display: flex; align-items: center; gap: 10px;
}
.answer-btn.animate-in { animation: fadeInUp 0.45s ease forwards; }
.answer-btn:hover:not(:disabled) {
  border-color: var(--secondary-glow); background: rgba(55, 195, 255, 0.1); transform: scale(1.02);
}
.answer-btn:disabled { cursor: not-allowed; opacity: 0.7; }

.option-prefix { font-weight: 800; color: var(--secondary-glow); min-width: 28px; }
.option-text { flex: 1; font-weight: 600; }

/* Final result markers */
.answer-btn.is-correct-final::after, .answer-btn.is-wrong-final::after {
  font-family: "Font Awesome 6 Free"; font-weight: 900;
  position: absolute; right: 18px; font-size: 1.4rem;
}
.answer-btn.is-correct-final { border-color: var(--success-glow); }
.answer-btn.is-correct-final::after { content: '\f00c'; color: var(--success-glow); }
.answer-btn.is-wrong-final { border-color: var(--danger-glow); }
.answer-btn.is-wrong-final::after { content: '\f00d'; color: var(--danger-glow); }

/* Flash highlights */
.answer-btn.highlight-correct {
  background: var(--success-glow); color: #111; border-color: var(--success-glow);
  transform: scale(1.05); box-shadow: 0 0 20px var(--success-glow);
}
.answer-btn.highlight-wrong {
  background: var(--danger-glow); color: #fff; border-color: var(--danger-glow);
  transform: scale(1.05); box-shadow: 0 0 20px var(--danger-glow);
}

/* Lifeline: hide two options (soft-hide for clarity) */
.answer-btn.hidden-option {
  opacity: 0.18;
  filter: grayscale(1) blur(0.5px);
  transform: scale(0.99);
  pointer-events: none;
}
.answer-btn.hidden-option .option-text {
  text-decoration: line-through;
  text-decoration-color: rgba(255,255,255,0.25);
}
.answer-btn.hidden-option::before {
  content: '\f070'; /* eye-slash */
  font-family: "Font Awesome 6 Free"; font-weight: 900;
  position: absolute; left: 10px; font-size: 0.95rem; color: rgba(255,255,255,0.45);
}

/* === Pause Overlay === */
.pause-overlay {
  position: absolute; inset: 0; background: rgba(0,0,0,0.6);
  display: none; align-items: center; justify-content: center; z-index: 50;
  border-radius: var(--border-radius);
}
.pause-overlay.show { display: flex; }
.pause-badge {
  background: rgba(255,255,255,0.95); color: #111; font-weight: 900;
  padding: 12px 20px; border-radius: 10px; font-size: 1.1rem;
  box-shadow: 0 0 20px var(--warning-glow);
}

/* === Footer === */
.game-footer {
  display: flex; justify-content: space-between; align-items: center; padding: 0 10px; gap: 20px; opacity: 20%;
}
.answer-type-selector { text-align: center; flex: 1; opacity: 1; }
.shortcut-hint { font-size: 0.86rem; color: var(--text-muted); margin-bottom: 8px; }
.answer-type-buttons { display: flex; gap: 8px; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 4px; }
.answer-type-btn {
  background: transparent; color: var(--text-muted); border: none;
  padding: 6px 12px; font-weight: 700; font-size: 0.86rem; border-radius: 6px; transition: all 0.2s ease;
}
.answer-type-btn.active {
  background: var(--secondary-glow); color: #111; box-shadow: 0 0 8px var(--secondary-glow);
}

/* === Feedback === */
#feedbackMessage {
  text-align: center; font-size: 1.3rem; font-weight: 800; padding: 12px;
  border-radius: 8px; transition: all 0.4s ease; opacity: 0;
  transform: translateY(20px); height: 0; overflow: hidden; margin: 0;
}
#feedbackMessage.show { opacity: 1; transform: translateY(0); height: auto; margin: 15px 0 0 0; }
#feedbackMessage.correct { color: var(--success-glow); background: rgba(0,255,195,0.12); }
#feedbackMessage.incorrect { color: var(--danger-glow); background: rgba(255,77,141,0.12); }

/* === Leaderboard === */
#final-winner { text-align: center; font-size: 1.8rem; margin-bottom: -10px; color: var(--success-glow); }
.leaderboard-card { display: flex; flex-direction: column; height: 100%; }
.leaderboard-title-bar { display: flex; justify-content: space-between; align-items: center; }
.leaderboard-actions { display: flex; gap: 10px; }

#leaderboardFilters { text-align: center; margin-bottom: 15px; }
.btn-filter {
  background: none; color: var(--text-muted); border: 1px solid var(--card-border);
  padding: 8px 16px; margin: 0 5px; border-radius: 20px; cursor: pointer; transition: all 0.3s ease;
}
.btn-filter.active {
  background: var(--secondary-glow); color: #111; border-color: var(--secondary-glow);
  box-shadow: 0 0 10px var(--secondary-glow);
}

.leaderboard-header {
  font-weight: 700; border-bottom: 2px solid var(--card-border);
  padding: 10px; color: var(--text-muted); font-size: 0.9rem;
}
.leaderboard-content-wrapper { overflow-y: auto; flex-grow: 1; }
.leaderboard-content-wrapper::-webkit-scrollbar { width: 6px; }
.leaderboard-content-wrapper::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); border-radius: 3px; }
.leaderboard-content-wrapper::-webkit-scrollbar-thumb { background: var(--primary-glow); border-radius: 3px; }

.leaderboard-header, .leaderboard-item { display: grid; align-items: center; font-size: 0.95rem; }
.leaderboard-header.individual, .leaderboard-item.individual {
  grid-template-columns: 0.5fr 2.5fr 1fr 0.8fr 0.8fr 1.2fr 0.8fr; gap: 10px;
}
.leaderboard-header.team, .leaderboard-item.team {
  grid-template-columns: 0.5fr 2fr 1fr 1fr 1fr 1.5fr; gap: 10px;
}

.leaderboard-item {
  padding: 12px 10px; border-bottom: 1px solid var(--card-border);
  transition: all 0.2s ease;
}
.leaderboard-item:last-child { border-bottom: none; }
.leaderboard-item:hover { background-color: rgba(255,255,255,0.05); }

.leaderboard-item.rank-1 {
  background: linear-gradient(90deg, rgba(255,215,0,0.15), transparent);
  border-left: 4px solid var(--rank1-color);
}
.leaderboard-item.rank-2 {
  background: linear-gradient(90deg, rgba(192,192,192,0.15), transparent);
  border-left: 4px solid var(--rank2-color);
}
.leaderboard-item.rank-3 {
  background: linear-gradient(90deg, rgba(205,127,50,0.15), transparent);
  border-left: 4px solid var(--rank3-color);
}

.preview-item {
  display: flex; justify-content: space-between; align-items: center;
  padding: 8px 10px; font-size: 0.9rem;
}
.player-info { display: flex; align-items: center; gap: 8px; }
.player-score { font-weight: 700; color: var(--success-glow); }

/* === Badges === */
.badge { font-size: 0.8rem; padding: 3px 8px; border-radius: 12px; font-weight: 700; }
.group-A { background: #3498db30; border: 1px solid #3498db80; color: #6ac5ff; }
.group-B { background: #e74c3c30; border: 1px solid #e74c3c80; color: #ff7b6d; }
.group-C { background: #2ecc7130; border: 1px solid #2ecc7180; color: #57ffaf; }
.group-D { background: #f39c1230; border: 1px solid #f39c1280; color: #ffc947; }
.group-E { background: #9b59b630; border: 1px solid #9b59b680; color: #c49adc; }
.group-F { background: #1abc9c30; border: 1px solid #1abc9c80; color: #48e4c7; }
.group-G { background: #e67e2230; border: 1px solid #e67e2280; color: #ffb366; }
.group-H { background: #34495e30; border: 1px solid #34495e80; color: #7f8c8d; }

/* === Notifications === */
.notification {
  position: fixed; top: 20px; right: 20px;
  padding: 12px 20px; border-radius: 8px; color: #fff; font-weight: 700;
  display: flex; align-items: center; gap: 8px;
  transform: translateX(400px); transition: transform 0.3s ease; z-index: 1000;
  box-shadow: 0 6px 24px rgba(0,0,0,0.35);
}
.notification.show { transform: translateX(0); }
.notification.success { background: linear-gradient(135deg, var(--success-glow), #00d4a3); }
.notification.info { background: linear-gradient(135deg, var(--info-glow), #0077cc); }

/* === Students Panel (Reusable + Modal) === */
.student-list {
  max-height: 300px; overflow-y: auto;
  display: grid; grid-template-columns: 1fr; gap: 8px;
}
.student-item {
  display: flex; align-items: center; justify-content: space-between; gap: 8px;
  padding: 10px 12px; background: rgba(255,255,255,0.05);
  border: 1px solid var(--card-border); border-radius: 10px;
}
.student-left { display: flex; align-items: center; gap: 10px; }
.student-name { font-weight: 700; }
.team-pill {
  padding: 2px 10px; border-radius: 999px; font-weight: 800; font-size: 0.8rem;
  border: 1px solid var(--card-border);
}
.team-letter {
  display: inline-block; min-width: 26px; text-align: center;
  border-radius: 6px; padding: 4px 6px; font-weight: 800;
  background: rgba(255,255,255,0.06); border: 1px solid var(--card-border);
  cursor: pointer; color: var(--text-color);
}
.team-letter.disabled { opacity: 0.4; pointer-events: none; }
.team-letter.active { background: var(--secondary-glow); color: #111; border-color: var(--secondary-glow); }

/* === Modal === */
.modal-overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,0.55);
  display: none; align-items: center; justify-content: center; z-index: 999;
  backdrop-filter: blur(4px);
}
.modal-overlay.show { display: flex; }
.modal-card {
  width: min(980px, 95vw); max-height: 90vh; overflow: hidden;
  background: var(--card-bg); border: 1px solid var(--card-border);
  border-radius: 16px; box-shadow: var(--shadow-strong);
  display: flex; flex-direction: column;
}
.modal-head {
  display: flex; align-items: center; justify-content: space-between;
  padding: 14px 18px; border-bottom: 1px solid var(--card-border);
}
.modal-title { font-weight: 800; font-size: 1.15rem; }
.modal-body { padding: 16px; overflow-y: auto; }
.modal-foot { padding: 12px 16px; border-top: 1px solid var(--card-border); display: flex; justify-content: flex-end; gap: 8px; }
.btn-icon-plain { background: transparent; border: none; color: var(--text-muted); font-size: 1.2rem; cursor: pointer; }
.btn-icon-plain:hover { color: var(--primary-glow); transform: scale(1.05); }

/* === Responsive (Desktop-first) === */
@media (max-width: 1100px) {
  .live-leaderboard { flex-direction: column; gap: 15px; }
  .live-section h4 { font-size: 0.8rem; }
  .live-list { max-height: 140px; }
}
@media (max-width: 900px) {
  .title { font-size: 2rem; }
  #setup-screen { grid-template-columns: 1fr; }
  #leaderboard-preview-container { min-height: 200px; }
  .answer-grid { grid-template-columns: 1fr; }
  .question-box { font-size: 1.6rem; padding: 20px; }
  .player-name { font-size: 1.6rem; }
  .answer-btn { font-size: 1rem; padding: 12px 15px; }
  .game-footer { flex-direction: column; gap: 15px; }
  .player-info-card { flex-direction: column; gap: 15px; }
  .settings-grid { grid-template-columns: 1fr; }
  .live-players-grid { grid-template-columns: 1fr; }
  .live-teams-section { display: none; }
}
@media (max-width: 600px) {
  .live-leaderboard { display: none; }
  .timer-container { width: 70px; height: 70px; }
  .timer-text { font-size: 1.8rem; }
  .game-container { padding: 10px; }
  .card { padding: 20px; }
  .leaderboard-header.individual, .leaderboard-item.individual {
    grid-template-columns: 0.5fr 2fr 1fr 0.7fr 0.7fr 1fr; font-size: 0.8rem;
  }
  .btn-icon-small { display: none; }
}
